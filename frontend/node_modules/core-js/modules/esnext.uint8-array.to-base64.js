'use strict';
var $ = require('../internals/export');
<<<<<<< HEAD
var globalThis = require('../internals/global-this');
var uncurryThis = require('../internals/function-uncurry-this');
var anObjectOrUndefined = require('../internals/an-object-or-undefined');
var anUint8Array = require('../internals/an-uint8-array');
var notDetached = require('../internals/array-buffer-not-detached');
=======
var global = require('../internals/global');
var uncurryThis = require('../internals/function-uncurry-this');
var anObjectOrUndefined = require('../internals/an-object-or-undefined');
var anUint8Array = require('../internals/an-uint8-array');
>>>>>>> 491790fa3284842aea531bfa9d2fd819794b4f37
var base64Map = require('../internals/base64-map');
var getAlphabetOption = require('../internals/get-alphabet-option');

var base64Alphabet = base64Map.i2c;
var base64UrlAlphabet = base64Map.i2cUrl;

<<<<<<< HEAD
=======
var Uint8Array = global.Uint8Array;
>>>>>>> 491790fa3284842aea531bfa9d2fd819794b4f37
var charAt = uncurryThis(''.charAt);

// `Uint8Array.prototype.toBase64` method
// https://github.com/tc39/proposal-arraybuffer-base64
<<<<<<< HEAD
if (globalThis.Uint8Array) $({ target: 'Uint8Array', proto: true }, {
=======
if (Uint8Array) $({ target: 'Uint8Array', proto: true, forced: true }, {
>>>>>>> 491790fa3284842aea531bfa9d2fd819794b4f37
  toBase64: function toBase64(/* options */) {
    var array = anUint8Array(this);
    var options = arguments.length ? anObjectOrUndefined(arguments[0]) : undefined;
    var alphabet = getAlphabetOption(options) === 'base64' ? base64Alphabet : base64UrlAlphabet;
<<<<<<< HEAD
    var omitPadding = !!options && !!options.omitPadding;
    notDetached(this.buffer);
=======
>>>>>>> 491790fa3284842aea531bfa9d2fd819794b4f37

    var result = '';
    var i = 0;
    var length = array.length;
    var triplet;

    var at = function (shift) {
      return charAt(alphabet, (triplet >> (6 * shift)) & 63);
    };

    for (; i + 2 < length; i += 3) {
      triplet = (array[i] << 16) + (array[i + 1] << 8) + array[i + 2];
      result += at(3) + at(2) + at(1) + at(0);
    }
    if (i + 2 === length) {
      triplet = (array[i] << 16) + (array[i + 1] << 8);
<<<<<<< HEAD
      result += at(3) + at(2) + at(1) + (omitPadding ? '' : '=');
    } else if (i + 1 === length) {
      triplet = array[i] << 16;
      result += at(3) + at(2) + (omitPadding ? '' : '==');
=======
      result += at(3) + at(2) + at(1) + '=';
    } else if (i + 1 === length) {
      triplet = array[i] << 16;
      result += at(3) + at(2) + '==';
>>>>>>> 491790fa3284842aea531bfa9d2fd819794b4f37
    }

    return result;
  }
});
